<!DOCTYPE html>
<html lang="fr">
	<head>
		<title>Cap'Chat</title>
		<meta charset="utf-8">
		<link href="https://unpkg.com/tailwindcss@^2/dist/tailwind.min.css" rel="stylesheet">
		<script>
			document.addEventListener('DOMContentLoaded', async () => {
				const captchat = document.getElementById("captchat")
				if (captchat === null) {
					console.error("CaptChat: Le captcha n'a pas été placé !")
					return
				}
				const jsonText = await fetch("/api/newsession").then(data => data.text())
				const json = JSON.parse(jsonText)
				console.log(json)
				captchat.innerHTML += `<h2>Indice : ${json['hint']}</h2>`
				captchat.innerHTML += "<div class='grid grid-cols-4 gap-4'>"
				// temp scope to destroy index variable
				{
					let index = 0
					for (const item of json.images) {
						captchat.innerHTML += `<button class="w-1/4" name="choice" value="${index}"><img src="${item}"></button>`
						++index
					}
				}
				captchat.innerHTML += "</div>"
				captchat.setAttribute('class', 'w-1/4')
			})
		</script>
	</head>
	<body>
		<main>
			<div id="captchat"></div>
		</main>
	</body>
</html>
